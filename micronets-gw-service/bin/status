#!/bin/bash

# set -x

if [ $# -eq 0 ]; then
  bridgename="brmn001"
elif [ $# -eq 1 ]; then
  bridgename="$1"
else
  echo "Error: Only 1 parameter allowed (bridge name)"
  exit 1
fi

shortname="${0##*/}"
script_dir="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null 2>&1 && pwd )"

echo "---------------------------------------------------------------------------------------"
echo "SHOWING STATUS FOR BRIDGE $bridgename"
echo "---------------------------------------------------------------------------------------"
ip address show dev $bridgename
echo "---------------------------------------------------------------------------------------"
sysctl net.ipv4.conf.$bridgename.send_redirects
sysctl net.ipv4.ip_forward
echo "---------------------------------------------------------------------------------------"
ovs-vsctl show
echo "---------------------------------------------------------------------------------------"
ovs-ofctl show $bridgename
echo "---------------------------------------------------------------------------------------"
ovs-ofctl dump-flows $bridgename --names | $script_dir/format-ofctl-dump
echo "---------------------------------------------------------------------------------------"
